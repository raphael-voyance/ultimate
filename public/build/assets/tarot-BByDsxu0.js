import{g as S}from"./index-DjKJqAo0.js";import{a as Ce}from"./axios-CCb-kr4I.js";document.addEventListener("DOMContentLoaded",()=>{const U=document.getElementById("drawing-cards");if(U){let we=function(){V.textContent=he[J]},F=function(){window.scrollTo({top:0,behavior:"smooth"}),J<Object.keys(he).length&&(J++,J<=4&&we()),J>4&&M==!1&&(V.classList.add("hidden"),oe.classList.remove("hidden"),re.classList.remove("hidden"))},A=window.location.hash;const P=document.getElementById("header-drawing-cards"),ie=document.getElementById("footer-drawing-cards");let z=new Date;z=z.toLocaleDateString();const _=document.getElementById("name-of-drawing-cards"),q=document.getElementById("total-cards-for-drawing-cards"),w=document.getElementById("tarot-cards"),Ee=document.getElementById("select-drawing-card-el"),f=document.getElementById("card_map"),ye=document.querySelectorAll("[data-to-step]"),ve=document.getElementById("btn-step-drawing-card"),j=document.getElementById("interpretation_drawing_card"),K=document.getElementById("spread-btn"),de=document.getElementById("shuffle-btn"),Q=document.getElementById("cut-btn");let x=JSON.parse(w.getAttribute("data-cards"));const X=JSON.parse(f.getAttribute("data-games"));let G;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?G=!0:G=!1;let k,D;G?(k=63.08,D=120):(k=114,D=216.83);let se=!1,N,C=0,O,Z,M=!1,T=[],le=[],$={};const be=[document.getElementById("sticky-header"),document.getElementById("sub-header")],Le=document.getElementById("footer");let ce=0;be.forEach(e=>{ce+=Number(e.offsetHeight)});let Se=Number(Le.offsetHeight);U.style.minHeight=`calc(100vh - ${ce}px - ${Se}px)`,function(){X.forEach(e=>{let t=document.createElement("li");t.setAttribute("data-total-cards",e.totalSelectedCards),t.classList="text-center cursor-pointer transition-all hover:scale-105";let a=e.name,r=document.createElement("h4");r.textContent=a;let n=e.description,o=document.createElement("p");o.textContent=n,r.classList="bg-accent/65",o.classList="bg-[#2800ff78] px-2",t.append(r),t.append(o),Ee.append(t),t.addEventListener("click",()=>{document.querySelectorAll("[data-total-cards]").forEach(l=>{l.classList.remove("scale-105")}),t.classList.add("scale-105"),ve.classList.remove("hidden"),N=e.totalSelectedCards,O=a,Z=e.slug,A=e.slug,_.innerText=O,q.innerText=`Vous avez sélectionné ${C} carte${C>1?"s":""} sur ${N}`})})}();const ue=function(e="Réaliser un nouveau tirage :"){let t=document.createElement("div"),a=document.createElement("ul"),r=document.createElement("span");X.filter(o=>o.slug!=A).forEach(o=>{let d=document.createElement("li"),l=document.createElement("a"),u=window.location.origin,c="/tarot",i="#"+o.slug,s=u+c;l.setAttribute("href",s+i),l.innerText=o.name,l.classList.add("btn","md:btn-sm","btn-primary","text-white/70","hover:text-white/70","active:text-white/70","focus:text-white/70"),d.append(l),a.append(d),l.addEventListener("click",function(m){m.preventDefault(),localStorage.removeItem("finalDrawToSave"),window.location=this.href,location.pathname=="/tarot"&&location.reload()})}),r.innerText=e,t.classList.add("p-4","bg-base-100","absolute","bottom-0","translate-y-full","w-full"),t.setAttribute("id","change_game_btns_container"),r.classList.add("text-xl","mb-3","inline-block"),a.classList.add("flex","gap-4","flex-wrap"),t.append(r),t.append(a),U.append(t)},R=function(e=null,t=null){window.scrollTo({top:0,behavior:"smooth"});const a=document.querySelectorAll("[data-step]");let r="DRAWING_CARD_INTRO",n=document.querySelector('[data-step="'+r+'"]');t!=null?(r=t,n=document.querySelector('[data-step="'+r+'"]'),a.forEach(o=>{o.classList.add("hidden")}),n&&n.classList.remove("hidden")):(r=e.getAttribute("data-to-step"),n=document.querySelector('[data-step="'+r+'"]'),a.forEach(o=>{o.classList.add("hidden")}),n.classList.remove("hidden")),r=="DRAWING_CARD"?(P.classList.remove("hidden"),ie.classList.remove("hidden"),se||me(x,w),ue()):P.classList.add("hidden")},me=function(e,t){se=!0,C=0,e.forEach((a,r)=>{let n=document.createElement("li"),o=document.createElement("div"),d=document.createElement("div");n.setAttribute("id","tarot-card-"+a.slug+"-"+a.id),n.setAttribute("data-number",a.numberArcane),n.classList.add("tarot-card"),o.classList.add("front-card"),d.classList.add("back-card"),n.style.width=k+"px",n.style.height=D+"px",t.style.width=k+"px",t.style.height=D+"px",o.innerHTML=`<img class="w-full h-full object-contain" src="${a.imgPath}"/>`,d.innerHTML='<img class="w-full h-full object-contain" src=" '+window.location.origin+'/imgs/tarot/back-card.png"/>',n.appendChild(d),n.appendChild(o),t.appendChild(n),Ie(n)})},De=function(){q.classList.remove("hidden");const e=w.getElementsByClassName("tarot-card"),t=e.length,a=360/t,r=G?100:180;for(let n=0;n<t;n++){const o=n*a,d=r*Math.cos(o*(Math.PI/180)),l=r*Math.sin(o*(Math.PI/180));e[n].style.transform=`translate(${d}px, ${l}px) rotate(${o+n*2}deg)`,e[n].addEventListener("mouseenter",()=>{e[n].style.transform=`translate(${d}px, ${l}px) rotate(${o+n*2}deg) scale(1.10)`}),e[n].addEventListener("mouseleave",()=>{e[n].style.transform=`translate(${d}px, ${l}px) rotate(${o+n*2}deg) scale(1)`})}w.classList.toggle("spread"),M=!0,K.classList.add("hidden"),q.parentElement.classList.remove("hidden"),F()},xe=function(){w.innerHTML="",C=0,x=S.utils.shuffle(x),me(x,w),T=[],q.innerText=`Vous avez sélectionné ${C} carte${C>1?"s":""} sur ${N}`;let e=document.querySelectorAll(".tarot-card");e.forEach((t,a)=>{S.to(t,{duration:.8,x:()=>S.utils.random(-260,260),y:()=>S.utils.random(-160,160),rotation:()=>S.utils.random(-120,120),stagger:0,ease:"power1-inOut",onComplete:()=>{S.to(e,{duration:.8,y:0,x:0,rotation:0,stagger:0,ease:"power1.inOut"}),de.classList.add("hidden"),Q.classList.remove("hidden"),Q.addEventListener("click",ke)}})}),F()},ke=function(){let t=w.children[1],a=Math.floor(Math.random()*22);x[a].id==x[0].id&&(a=Math.floor(Math.random()*22)),le=["cut",x[a].id,x[0].id],Array.from(t.classList).find(r=>r.startsWith("-translate-x-")),t.classList.add("transition-all"),t.classList.add("!translate-x-[105%]"),t.classList.add("z-10"),setTimeout(function(r){t.classList.remove("!translate-x-[105%]"),t.classList.remove("z-10"),setTimeout(function(){t.classList.remove("transition-all")},100)},500),Q.classList.add("hidden"),K.classList.remove("hidden"),K.addEventListener("click",De),F()},Te=function(){document.querySelectorAll(".tarot-card").forEach(t=>{S.to(t,{duration:1,x:()=>0,y:()=>0,rotation:()=>0,stagger:.2,ease:"power1.inOut"})})},Ie=function(e){e.addEventListener("click",function(){let t=e.getAttribute("id").split("-").pop(),a=T.find(r=>r==t);M&&(e.classList.add("selected","ring-2","ring-primary"),T.push(parseInt(t))),e.classList.contains("selected")&&a==t&&(e.classList.remove("selected","ring-2","ring-primary"),T=T.filter(r=>r!=t),M=!0),Be()})},Be=function(){T.length==N?(M=!1,j.classList.remove("hidden")):(M=!0,j.classList.add("hidden")),C=T.length,q.innerText=`Vous avez sélectionné ${C} carte${C>1?"s":""} sur ${N}`},qe=async()=>{try{const e=await pe(T,Z),t=await pe(le,"cut"),a=e.data,n={cut:t.data,draw:a};j.classList.add("hidden"),Te(),F(),$=n,$.date=z,$.name=O,localStorage.setItem("finalDrawToSave",JSON.stringify($));let o=a.drawSlug;o=="tirage-de-la-journee"?ne(n):o=="tirage-de-l-annee"?ae(n):o=="tirage-en-croix"?ee(n):te(n);return}catch(e){console.error("Erreur lors de l'interprétation du tirage :",e)}},pe=async(e,t)=>{try{let a=window.location.origin+"/tarot/interpretation";return Ce({method:"get",url:a,params:{drawCards:e,drawSlug:t}})}catch(a){throw console.error("Erreur lors de la requête au serveur :",a.message),a}};j.addEventListener("click",()=>{q.style.display="none",F(),qe()});const W=function(e){const t=e.draw,a=document.getElementById("draw-interpretation-block-cut").content,r=document.getElementById("cut-interpretation-card").content;let o=document.importNode(a,!0).querySelector(".tarot-cards-container"),d=o.querySelector(".block-interpretation"),l=document.createElement("div");console.log(d),Object.entries(t).forEach(([u,c])=>{if(!c.name)return;let i=document.importNode(r,!0),s=document.createElement("div"),m=document.createElement("h4"),p=document.createElement("span"),g=document.createElement("span"),E=document.createElement("p");i.querySelector(".card-img").setAttribute("src",c.path),i.querySelector(".tarot-card").style.width=k+"px",i.querySelector(".tarot-card").style.height=D+"px",g.innerText=c.nbArcane+" - ",p.innerText=c.name,m.appendChild(g),m.appendChild(p),E.innerText=c.interpretation,s.appendChild(m),s.appendChild(E),d.appendChild(s),l.appendChild(i)}),l.classList.add("block-cards-cut"),o.appendChild(l),f.firstElementChild.appendChild(o)},ee=function(e){console.log("process draw",e),S.to(w,{duration:1,scale:.8,opacity:0,ease:"power1.out",onComplete:()=>{setTimeout(()=>{w.remove(),f.classList.add("draw-cross"),W(e.cut);const a=e.draw.draw,r=document.getElementById("draw-interpretation-block-draw-cross").content,n=document.getElementById("draw-interpretation-card-draw-cross").content;let d=document.importNode(r,!0).querySelector(".tarot-cards-container"),l=d.querySelector(".block-interpretation"),u=document.createElement("div"),c=[];if(a.drawPositions)try{c=JSON.parse(JSON.parse(a.drawPositions))}catch(i){console.error("Error parsing JSON: ",i)}console.log(c),Object.entries(a).forEach(([i,s])=>{if(!s.name)return;let m=document.importNode(n,!0),p=document.createElement("div"),g=document.createElement("h4"),E=document.createElement("span"),I=document.createElement("span"),B=document.createElement("p");m.querySelector(".card-img").setAttribute("src",s.path),m.querySelector(".tarot-card").style.width=k+"px",m.querySelector(".tarot-card").style.height=D+"px",I.innerText=s.nbArcane+" - ",E.innerText=s.name,g.appendChild(I),g.appendChild(E),B.innerText=s.interpretation;let h=document.createElement("div"),y=document.createElement("span"),v=document.createElement("span"),b=document.createElement("span");h.classList.add("domaine"),y.classList.add("draw-domaine-icone"),v.classList.add("draw-domaine-text"),b.classList.add("draw-domaine-position");const L=c.find(H=>H.position===parseInt(i)+1);L&&(b.innerHTML=parseInt(i)+1,y.innerHTML=`<i class="${L.icone}"></i>`,v.innerText=L.keywords,h.appendChild(b),h.appendChild(v),h.appendChild(y),p.appendChild(h)),p.appendChild(g),p.appendChild(B),l.appendChild(p),u.appendChild(m)}),u.style.minHeight=D*3+"px",u.classList.add("block-cards-draw"),d.appendChild(u),f.firstElementChild.appendChild(d)},500)}})},te=function(e){S.to(w,{duration:1,scale:.8,opacity:0,ease:"power1.out",onComplete:()=>{setTimeout(()=>{w.remove(),f.classList.add("draw-spread"),W(e.cut);const a=e.draw.draw,r=document.getElementById("draw-interpretation-block-draw-spread").content,n=document.getElementById("draw-interpretation-card-draw-spread").content;let d=document.importNode(r,!0).querySelector(".tarot-cards-container"),l=d.querySelector(".block-interpretation"),u=document.createElement("div"),c=[];if(a.drawPositions)try{c=JSON.parse(JSON.parse(a.drawPositions))}catch(i){console.error("Error parsing JSON: ",i)}console.log(c),Object.entries(a).forEach(([i,s])=>{if(!s.name)return;let m=document.importNode(n,!0),p=document.createElement("div"),g=document.createElement("h4"),E=document.createElement("span"),I=document.createElement("span"),B=document.createElement("p");m.querySelector(".card-img").setAttribute("src",s.path),m.querySelector(".tarot-card").style.width=k+"px",m.querySelector(".tarot-card").style.height=D+"px",I.innerText=s.nbArcane+" - ",E.innerText=s.name,g.appendChild(I),g.appendChild(E),B.innerText=s.interpretation;let h=document.createElement("div"),y=document.createElement("span"),v=document.createElement("span"),b=document.createElement("span");h.classList.add("domaine"),y.classList.add("draw-domaine-icone"),v.classList.add("draw-domaine-text"),b.classList.add("draw-domaine-position");const L=c.find(H=>H.position===parseInt(i)+1);L&&(b.innerHTML=parseInt(i)+1,y.innerHTML=`<i class="${L.icone}"></i>`,v.innerText=L.keywords,h.appendChild(b),h.appendChild(v),h.appendChild(y),p.appendChild(h)),p.appendChild(g),p.appendChild(B),l.appendChild(p),u.appendChild(m)}),u.style.minHeight=D*3+"px",u.classList.add("block-cards-draw"),d.appendChild(u),f.firstElementChild.appendChild(d)},500)}})},ae=function(e){S.to(w,{duration:1,scale:.8,opacity:0,ease:"power1.out",onComplete:()=>{setTimeout(()=>{w.remove(),f.classList.add("draw-year"),W(e.cut);const a=e.draw.draw,r=document.getElementById("draw-interpretation-block-draw-year").content,n=document.getElementById("draw-interpretation-card-draw-year").content;let d=document.importNode(r,!0).querySelector(".tarot-cards-container");const l=JSON.parse(JSON.parse(a.drawPositions));Object.entries(a).forEach(([u,c])=>{if(!c.name)return;let i=document.importNode(n,!0);i.querySelector(".block-card-year .card-img").setAttribute("src",c.path),i.querySelector(".card-nb").innerText=c.nbArcane+" - ",i.querySelector(".card-name").innerText=c.name,i.querySelector(".card-interpretation-text").innerText=c.interpretation;const s=l.find(m=>m.position===parseInt(u)+1);s?(i.querySelector(".draw-domaine-icone").innerHTML=`<i class="${s.icone}"></i>`,i.querySelector(".draw-domaine-text").innerText=s.keywords):(i.querySelector(".draw-domaine-icone").innerHTML='<i class="fa-thin fa-t-rex"></i>',i.querySelector(".draw-domaine-text").innerText="Général"),d.appendChild(i)}),f.firstElementChild.appendChild(d)},500)}})},ne=function(e){S.to(w,{duration:1,scale:.8,opacity:0,ease:"power1.out",onComplete:()=>{setTimeout(()=>{w.remove(),f.classList.add("draw-day"),W(e.cut);const a=e.draw.draw,r=document.getElementById("draw-interpretation-block-draw-day").content,n=document.getElementById("draw-interpretation-card-draw-day").content;let d=document.importNode(r,!0).querySelector(".tarot-cards-container"),l=d.querySelector(".block-interpretation"),u=document.createElement("div"),c=[];if(a.drawPositions)try{c=JSON.parse(JSON.parse(a.drawPositions))}catch(i){console.error("Error parsing JSON: ",i)}console.log(c),Object.entries(a).forEach(([i,s])=>{if(!s.name)return;let m=document.importNode(n,!0),p=document.createElement("div"),g=document.createElement("h4"),E=document.createElement("span"),I=document.createElement("span"),B=document.createElement("p");m.querySelector(".card-img").setAttribute("src",s.path),m.querySelector(".tarot-card").style.width=k+"px",m.querySelector(".tarot-card").style.height=D+"px",I.innerText=s.nbArcane+" - ",E.innerText=s.name,g.appendChild(I),g.appendChild(E),B.innerText=s.interpretation;let h=document.createElement("div"),y=document.createElement("span"),v=document.createElement("span"),b=document.createElement("span");h.classList.add("domaine"),y.classList.add("draw-domaine-icone"),v.classList.add("draw-domaine-text"),b.classList.add("draw-domaine-position");const L=c.find(H=>H.position===parseInt(i)+1);L&&(b.innerHTML=parseInt(i)+1,y.innerHTML=`<i class="${L.icone}"></i>`,v.innerText=L.keywords,h.appendChild(b),h.appendChild(v),h.appendChild(y),p.appendChild(h)),p.appendChild(g),p.appendChild(B),l.appendChild(p),u.appendChild(m)}),u.classList.add("block-cards-draw"),d.appendChild(u),f.firstElementChild.appendChild(d)},500)}})};let re=document.getElementById("date-of-drawing-cards");re.innerText="Le : "+z;let J=0,V=document.getElementById("notice-of-drawing-cards"),oe=document.getElementById("draw-actions"),he={0:'Faites le vide dans votre esprit et respirez tranquillement trois fois puis mélangez les cartes en cliquant sur le bouton "Mélanger"',1:'Parfait, maintenant, concentrez-vous sur votre question puis coupez les cartes en cliquant sur le bouton "Couper"',2:'Maintenant, étalez le jeu en cliquant sur le bouton "Etaler"',3:"Parmis les cartes qui se présentent à vous, sélectionnez celles qui vous inspirent en cliquant sur chacune d'elles, vous pouvez en changer, mais sachez que votre première intuition est souvent la bonne, restez léger.",4:'Bien, maintenant que vous avez sélectionné toutes vos cartes pour votre tirage, cliquez sur le bouton "Interpréter mon tirage" pour obtenir votre interprétation.'};we();const Ne=document.getElementById("open-save-draw"),ge=document.getElementById("drawer-save"),Y=document.getElementById("new-draw"),Ae=document.getElementById("drawer-save-close"),fe=document.getElementById("save-draw-btn");Y.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation();let t=e.target;for(;t&&t!==Y;)t=t.parentNode;if(t===Y){const a=Y.getAttribute("href");localStorage.removeItem("finalDrawToSave"),window.location=a}}),Ne.addEventListener("click",e=>{e.preventDefault(),ge.setAttribute("checked",!0)}),Ae.addEventListener("click",e=>{e.preventDefault(),ge.removeAttribute("checked")}),fe&&fe.addEventListener("click",e=>{e.preventDefault(),Oe($)});const Oe=function(e){const t=localStorage.getItem("finalDrawToSave"),a=t||e;console.log("name",O),Ce({method:"post",url:"/tarot/save-draw-cards",data:{draw:JSON.parse(a)}}).then(function(r){r.status==200?(console.log("Tirage enregistré avec succès",r.data.id),localStorage.removeItem("finalDrawToSave"),window.location=window.location.origin+"/tarot/tirage/"+r.data.id):console.error("Erreur lors de l'enregistrement du tirage")})};A&&(A=A.substring(1),X.forEach(e=>{e.slug==A&&(P.classList.remove("hidden"),R(null,"DRAWING_CARD"),N=e.totalSelectedCards,O=e.name,Z=e.slug,_.innerText=O,q.innerText=`Vous avez sélectionné ${C} carte${C>1?"s":""} sur ${N}`)})),ye.forEach(e=>{e.addEventListener("click",()=>{R(e)})}),de.addEventListener("click",xe),function(){const e=document.querySelector("[data-user-draw]");if(e){const a=e.getAttribute("data-user-draw");if(a!=="")try{R(null,"FINALY_STEP"),f.classList.remove("hidden"),P.classList.remove("hidden"),ue("Réaliser un nouveau tirage :"),V.classList.add("hidden"),oe.classList.remove("hidden");const r=a.replace(/&quot;/g,'"'),n=JSON.parse(r),o=n.draw,d=JSON.parse(o.replace(/&quot;/g,'"').replace(/&#039;/g,"'"));let l=document.getElementById("date-of-drawing-cards");l.innerText="Le : "+d.date,l.classList.remove("hidden"),console.log("unescapedNestedDraw",d);const u=d,i=u.draw.drawSlug,s=n.created_at,m=n.updated_at;_.innerText=u.name,i=="tirage-de-la-journee"?ne(u):i=="tirage-de-l-annee"?ae(u):i=="tirage-en-croix"?ee(u):te(u);return}catch(r){console.error("Erreur lors du parsing JSON :",r)}}const t=JSON.parse(localStorage.getItem("finalDrawToSave"));if(t){console.log("savedFinalDraw",t);try{R(null,"FINALY_STEP"),f.classList.remove("hidden"),P.classList.remove("hidden"),ie.classList.add("hidden"),V.classList.add("hidden"),oe.classList.remove("hidden"),re.classList.remove("hidden"),_.innerText=t.name;const r=t.draw.drawSlug;r=="tirage-de-la-journee"?ne(t):r=="tirage-de-l-annee"?ae(t):r=="tirage-en-croix"?ee(t):te(t);return}catch(a){console.error("Erreur lors du parsing JSON :",a)}return}}()}});
