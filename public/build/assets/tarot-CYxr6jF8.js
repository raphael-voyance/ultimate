import{g as x}from"./index-DjKJqAo0.js";import{a as he}from"./axios-B4uVmeYG.js";document.addEventListener("DOMContentLoaded",()=>{const z=document.getElementById("drawing-cards");if(z){let A=window.location.hash;const F=document.getElementById("header-drawing-cards"),Z=document.getElementById("footer-drawing-cards"),W=document.getElementById("name-of-drawing-cards"),q=document.getElementById("total-cards-for-drawing-cards"),w=document.getElementById("tarot-cards"),ee=document.getElementById("select-drawing-card-el"),S=document.getElementById("card_map"),te=document.querySelectorAll("[data-to-step]"),ne=document.getElementById("btn-step-drawing-card"),M=document.getElementById("interpretation_drawing_card"),J=document.getElementById("spread-btn"),V=document.getElementById("shuffle-btn"),G=document.getElementById("cut-btn");let v=JSON.parse(w.getAttribute("data-cards"));const j=JSON.parse(w.getAttribute("data-games"));let $;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?$=!0:$=!1;let D,k;$?(D=63.08,k=120):(D=114,k=216.83);let U=!1,N,g=0,P,R,_=!1,B=[],Y=[];(function(){j.forEach(e=>{let t=document.createElement("li");t.setAttribute("data-total-cards",e.totalSelectedCards),t.classList="text-center cursor-pointer transition-all hover:scale-105";let n=e.name,o=document.createElement("h4");o.textContent=n;let a=e.description,r=document.createElement("p");r.textContent=a,o.classList="bg-accent",r.classList="bg-secondary px-2",t.append(o),t.append(r),ee.append(t),t.addEventListener("click",()=>{document.querySelectorAll("[data-total-cards]").forEach(p=>{p.classList.remove("scale-105")}),t.classList.add("scale-105"),ne.classList.remove("hidden"),N=e.totalSelectedCards,P=n,R=e.slug,A=e.slug,W.innerText=P,q.innerText=`Vous avez sélectionné ${g} carte${g>1?"s":""} sur ${N}`})})})();const K=function(e=null,t=null){const n=document.querySelectorAll("[data-step]");let o="DRAWING_CARD_INTRO",a=document.querySelector('[data-step="'+o+'"]');if(t!=null?(o=t,a=document.querySelector('[data-step="'+o+'"]'),n.forEach(r=>{r.classList.add("hidden")}),a.classList.remove("hidden")):(o=e.getAttribute("data-to-step"),a=document.querySelector('[data-step="'+o+'"]'),n.forEach(r=>{r.classList.add("hidden")}),a.classList.remove("hidden")),o=="DRAWING_CARD"){F.classList.remove("hidden"),Z.classList.remove("hidden"),U||Q(v,w);let r=document.createElement("div"),l=document.createElement("ul"),p=document.createElement("span");j.filter(s=>s.slug!=A).forEach(s=>{let d=document.createElement("li"),i=document.createElement("a"),c=window.location.origin,m=window.location.pathname,h="#"+s.slug,E=c+m;i.setAttribute("href",E+h),i.innerText=s.name,i.classList.add("btn","md:btn-sm","btn-primary","text-white/70","hover:text-white/70","active:text-white/70","focus:text-white/70"),d.append(i),l.append(d),i.addEventListener("click",function(T){T.preventDefault(),window.location.hash=h,location.reload()})}),p.innerText="Changer de tirage :",r.classList.add("p-4","bg-base-100","relative","-top-20"),p.classList.add("text-xl","mb-3","inline-block"),l.classList.add("flex","gap-4","flex-wrap"),r.append(p),r.append(l),z.append(r)}else F.classList.add("hidden")},Q=function(e,t){U=!0,g=0,e.forEach((n,o)=>{let a=document.createElement("li"),r=document.createElement("div"),l=document.createElement("div");a.setAttribute("id","tarot-card-"+n.slug+"-"+n.id),a.setAttribute("data-number",n.numberArcane),a.classList.add("tarot-card"),r.classList.add("front-card"),l.classList.add("back-card"),a.style.width=D+"px",a.style.height=k+"px",t.style.width=D+"px",t.style.height=k+"px",r.innerHTML=`<img class="w-full h-full object-contain" src="${n.imgPath}"/>`,l.innerHTML='<img class="w-full h-full object-contain" src=" '+window.location.origin+'/imgs/tarot/back-card.png"/>',a.appendChild(l),a.appendChild(r),t.appendChild(a),ie(a)})},ae=function(){q.classList.remove("hidden");const e=w.getElementsByClassName("tarot-card"),t=e.length,n=360/t,o=$?100:180;for(let a=0;a<t;a++){const r=a*n,l=o*Math.cos(r*(Math.PI/180)),p=o*Math.sin(r*(Math.PI/180));e[a].style.transform=`translate(${l}px, ${p}px) rotate(${r+a*2}deg)`,e[a].addEventListener("mouseenter",()=>{e[a].style.transform=`translate(${l}px, ${p}px) rotate(${r+a*2}deg) scale(1.10)`}),e[a].addEventListener("mouseleave",()=>{e[a].style.transform=`translate(${l}px, ${p}px) rotate(${r+a*2}deg) scale(1)`})}w.classList.toggle("spread"),_=!0,J.classList.add("hidden"),q.parentElement.classList.remove("hidden")},re=function(){w.innerHTML="",g=0,v=x.utils.shuffle(v),Q(v,w),B=[],q.innerText=`Vous avez sélectionné ${g} carte${g>1?"s":""} sur ${N}`;let e=document.querySelectorAll(".tarot-card");e.forEach((t,n)=>{x.to(t,{duration:.8,x:()=>x.utils.random(-260,260),y:()=>x.utils.random(-160,160),rotation:()=>x.utils.random(-120,120),stagger:0,ease:"power1-inOut",onComplete:()=>{x.to(e,{duration:.8,y:0,x:0,rotation:0,stagger:0,ease:"power1.inOut"}),V.classList.add("hidden"),G.classList.remove("hidden"),G.addEventListener("click",oe)}})})},oe=function(){let t=w.children[1],n=Math.floor(Math.random()*22);v[n].id==v[0].id&&(n=Math.floor(Math.random()*22)),Y=["cut",v[n].id,v[0].id],Array.from(t.classList).find(o=>o.startsWith("-translate-x-")),t.classList.add("transition-all"),t.classList.add("!translate-x-[105%]"),t.classList.add("z-10"),setTimeout(function(o){t.classList.remove("!translate-x-[105%]"),t.classList.remove("z-10"),setTimeout(function(){t.classList.remove("transition-all")},100)},500),G.classList.add("hidden"),J.classList.remove("hidden"),J.addEventListener("click",ae)},de=function(){document.querySelectorAll(".tarot-card").forEach(t=>{x.to(t,{duration:1,x:()=>0,y:()=>0,rotation:()=>0,stagger:.2,ease:"power1.inOut"})})},ie=function(e){e.addEventListener("click",function(){let t=e.getAttribute("id").split("-").pop(),n=B.find(o=>o==t);_&&(e.classList.add("selected","ring-2","ring-primary"),B.push(parseInt(t))),e.classList.contains("selected")&&n==t&&(e.classList.remove("selected","ring-2","ring-primary"),B=B.filter(o=>o!=t)),le()})},le=function(){B.length==N?(_=!1,M.classList.remove("hidden")):M.classList.add("hidden"),g=B.length,q.innerText=`Vous avez sélectionné ${g} carte${g>1?"s":""} sur ${N}`},se=async()=>{try{const e=await X(B,R),t=await X(Y,"cut"),n=e.data,a={cut:t.data,draw:n};M.classList.add("hidden"),de();let r=n.drawSlug;r=="tirage-de-la-journee"?ue(a):r=="tirage-de-l-annee"?me(a):r=="tirage-en-croix"?ce(a):pe(a);return}catch(e){console.error("Erreur lors de l'interprétation du tirage :",e)}},X=async(e,t)=>{try{return he({method:"get",url:"http://ultimate.test/mon-espace/previsions/tarot/interpretation",params:{drawCards:e,drawSlug:t}})}catch(n){throw console.error("Erreur lors de la requête au serveur :",n.message),n}};M.addEventListener("click",()=>{q.style.display="none",se()});const H=function(e){const t=e.draw,n=document.getElementById("draw-interpretation-block-cut").content,o=document.getElementById("cut-interpretation-card").content;let r=document.importNode(n,!0).querySelector(".tarot-cards-container"),l=r.querySelector(".block-interpretation"),p=document.createElement("div");console.log(l),Object.entries(t).forEach(([u,s])=>{if(!s.name)return;let d=document.importNode(o,!0),i=document.createElement("div"),c=document.createElement("h4"),m=document.createElement("span"),h=document.createElement("span"),E=document.createElement("p");d.querySelector(".card-img").setAttribute("src",s.path),d.querySelector(".tarot-card").style.width=D+"px",d.querySelector(".tarot-card").style.height=k+"px",h.innerText=s.nbArcane+" - ",m.innerText=s.name,c.appendChild(h),c.appendChild(m),E.innerText=s.interpretation,i.appendChild(c),i.appendChild(E),l.appendChild(i),p.appendChild(d)}),p.classList.add("block-cards-cut"),r.appendChild(p),S.firstElementChild.appendChild(r)},ce=function(e){console.log("process draw",e),x.to(w,{duration:1,scale:.8,opacity:0,ease:"power1.out",onComplete:()=>{setTimeout(()=>{w.remove(),S.classList.add("draw-cross"),H(e.cut);const n=e.draw.draw,o=document.getElementById("draw-interpretation-block-draw-cross").content,a=document.getElementById("draw-interpretation-card-draw-cross").content;let l=document.importNode(o,!0).querySelector(".tarot-cards-container"),p=l.querySelector(".block-interpretation"),u=document.createElement("div"),s=[];if(n.drawPositions)try{s=JSON.parse(JSON.parse(n.drawPositions))}catch(d){console.error("Error parsing JSON: ",d)}console.log(s),Object.entries(n).forEach(([d,i])=>{if(!i.name)return;let c=document.importNode(a,!0),m=document.createElement("div"),h=document.createElement("h4"),E=document.createElement("span"),T=document.createElement("span"),I=document.createElement("p");c.querySelector(".card-img").setAttribute("src",i.path),c.querySelector(".tarot-card").style.width=D+"px",c.querySelector(".tarot-card").style.height=k+"px",T.innerText=i.nbArcane+" - ",E.innerText=i.name,h.appendChild(T),h.appendChild(E),I.innerText=i.interpretation;let C=document.createElement("div"),y=document.createElement("span"),f=document.createElement("span"),b=document.createElement("span");C.classList.add("domaine"),y.classList.add("draw-domaine-icone"),f.classList.add("draw-domaine-text"),b.classList.add("draw-domaine-position");const L=s.find(O=>O.position===parseInt(d)+1);L&&(b.innerHTML=parseInt(d)+1,y.innerHTML=`<i class="${L.icone}"></i>`,f.innerText=L.keywords,C.appendChild(b),C.appendChild(f),C.appendChild(y),m.appendChild(C)),m.appendChild(h),m.appendChild(I),p.appendChild(m),u.appendChild(c)}),u.style.minHeight=k*3+"px",u.classList.add("block-cards-draw"),l.appendChild(u),S.firstElementChild.appendChild(l)},500)}})},pe=function(e){console.log("process draw",e),x.to(w,{duration:1,scale:.8,opacity:0,ease:"power1.out",onComplete:()=>{setTimeout(()=>{w.remove(),S.classList.add("draw-spread"),H(e.cut);const n=e.draw.draw,o=document.getElementById("draw-interpretation-block-draw-spread").content,a=document.getElementById("draw-interpretation-card-draw-spread").content;let l=document.importNode(o,!0).querySelector(".tarot-cards-container"),p=l.querySelector(".block-interpretation"),u=document.createElement("div"),s=[];if(n.drawPositions)try{s=JSON.parse(JSON.parse(n.drawPositions))}catch(d){console.error("Error parsing JSON: ",d)}console.log(s),Object.entries(n).forEach(([d,i])=>{if(!i.name)return;let c=document.importNode(a,!0),m=document.createElement("div"),h=document.createElement("h4"),E=document.createElement("span"),T=document.createElement("span"),I=document.createElement("p");c.querySelector(".card-img").setAttribute("src",i.path),c.querySelector(".tarot-card").style.width=D+"px",c.querySelector(".tarot-card").style.height=k+"px",T.innerText=i.nbArcane+" - ",E.innerText=i.name,h.appendChild(T),h.appendChild(E),I.innerText=i.interpretation;let C=document.createElement("div"),y=document.createElement("span"),f=document.createElement("span"),b=document.createElement("span");C.classList.add("domaine"),y.classList.add("draw-domaine-icone"),f.classList.add("draw-domaine-text"),b.classList.add("draw-domaine-position");const L=s.find(O=>O.position===parseInt(d)+1);L&&(b.innerHTML=parseInt(d)+1,y.innerHTML=`<i class="${L.icone}"></i>`,f.innerText=L.keywords,C.appendChild(b),C.appendChild(f),C.appendChild(y),m.appendChild(C)),m.appendChild(h),m.appendChild(I),p.appendChild(m),u.appendChild(c)}),u.style.minHeight=k*3+"px",u.classList.add("block-cards-draw"),l.appendChild(u),S.firstElementChild.appendChild(l)},500)}})},me=function(e){x.to(w,{duration:1,scale:.8,opacity:0,ease:"power1.out",onComplete:()=>{setTimeout(()=>{w.remove(),S.classList.add("draw-year"),H(e.cut);const n=e.draw.draw,o=document.getElementById("draw-interpretation-block-draw-year").content,a=document.getElementById("draw-interpretation-card-draw-year").content;let l=document.importNode(o,!0).querySelector(".tarot-cards-container");const p=JSON.parse(JSON.parse(n.drawPositions));Object.entries(n).forEach(([u,s])=>{if(!s.name)return;let d=document.importNode(a,!0);d.querySelector(".block-card-year .card-img").setAttribute("src",s.path),d.querySelector(".card-nb").innerText=s.nbArcane+" - ",d.querySelector(".card-name").innerText=s.name,d.querySelector(".card-interpretation-text").innerText=s.interpretation;const i=p.find(c=>c.position===parseInt(u)+1);i?(d.querySelector(".draw-domaine-icone").innerHTML=`<i class="${i.icone}"></i>`,d.querySelector(".draw-domaine-text").innerText=i.keywords):(d.querySelector(".draw-domaine-icone").innerHTML='<i class="fa-thin fa-t-rex"></i>',d.querySelector(".draw-domaine-text").innerText="Général"),l.appendChild(d)}),S.firstElementChild.appendChild(l)},500)}})},ue=function(e){x.to(w,{duration:1,scale:.8,opacity:0,ease:"power1.out",onComplete:()=>{setTimeout(()=>{w.remove(),S.classList.add("draw-day"),H(e.cut);const n=e.draw.draw,o=document.getElementById("draw-interpretation-block-draw-day").content,a=document.getElementById("draw-interpretation-card-draw-day").content;let l=document.importNode(o,!0).querySelector(".tarot-cards-container"),p=l.querySelector(".block-interpretation"),u=document.createElement("div"),s=[];if(n.drawPositions)try{s=JSON.parse(JSON.parse(n.drawPositions))}catch(d){console.error("Error parsing JSON: ",d)}console.log(s),Object.entries(n).forEach(([d,i])=>{if(!i.name)return;let c=document.importNode(a,!0),m=document.createElement("div"),h=document.createElement("h4"),E=document.createElement("span"),T=document.createElement("span"),I=document.createElement("p");c.querySelector(".card-img").setAttribute("src",i.path),c.querySelector(".tarot-card").style.width=D+"px",c.querySelector(".tarot-card").style.height=k+"px",T.innerText=i.nbArcane+" - ",E.innerText=i.name,h.appendChild(T),h.appendChild(E),I.innerText=i.interpretation;let C=document.createElement("div"),y=document.createElement("span"),f=document.createElement("span"),b=document.createElement("span");C.classList.add("domaine"),y.classList.add("draw-domaine-icone"),f.classList.add("draw-domaine-text"),b.classList.add("draw-domaine-position");const L=s.find(O=>O.position===parseInt(d)+1);L&&(b.innerHTML=parseInt(d)+1,y.innerHTML=`<i class="${L.icone}"></i>`,f.innerText=L.keywords,C.appendChild(b),C.appendChild(f),C.appendChild(y),m.appendChild(C)),m.appendChild(h),m.appendChild(I),p.appendChild(m),u.appendChild(c)}),u.classList.add("block-cards-draw"),l.appendChild(u),S.firstElementChild.appendChild(l)},500)}})};A&&(A=A.substring(1),j.forEach(e=>{e.slug==A&&(F.classList.remove("hidden"),K(null,"DRAWING_CARD"),N=e.totalSelectedCards,P=e.name,R=e.slug,W.innerText=P,q.innerText=`Vous avez sélectionné ${g} carte${g>1?"s":""} sur ${N}`)})),te.forEach(e=>{e.addEventListener("click",()=>{K(e)})}),V.addEventListener("click",re)}});
