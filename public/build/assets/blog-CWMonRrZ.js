import{a as g}from"./axios-CCb-kr4I.js";import{a as D}from"./utils-Cf_47s1-.js";import{c as C}from"./alert-BjNJBOmD.js";import{T as _,c as q,d as R,f as P,m as M,r as F,s as $,n as N,a as O,I as U,P as j,b as H}from"./bundle-Cokl53mf.js";/* empty css              */import"./_commonjsHelpers-Cpj98o6Y.js";window.addEventListener("load",()=>{const T=document.getElementById("blog-index"),E=document.getElementById("blog-create"),f=document.getElementById("blog-edit");let y={};if(T){let n=document.querySelectorAll("[data-copy-link]"),o=document.querySelectorAll("[data-btn-post-del]");n.length>0&&n.forEach(t=>{t.addEventListener("click",function(a){a.preventDefault(),A(t)})}),o&&o.forEach(t=>{t.addEventListener("click",a=>{const d=t.getAttribute("data-btn-post-del");a.preventDefault(),C("Vous êtes sur le point de supprimer un article, êtes-vous sûr(e) ?","default",function(l){l?(console.log(l),g.delete(d).then(function(s){s.data.status=="success"&&(window.location=s.data.redirectRoute)}).catch(function(s){console.log(s),Toast.danger("Il y a eu une erreur dans le processus de suppression de l'article, merci de réessayer après avoir rafraichi votre navigateur.")})):console.log("Suppression annulée !")})})})}if(E||f){let w=function(e,p){const u=document.getElementById("categories-list"),i=document.createElement("div");i.innerHTML=`<div class="form-control" x-show="true">
                        <label for="${e}" class="label cursor-pointer gap-2 justify-start">
                            <input type="checkbox" id="${e}" name="${e}" value="${p}" class="checkbox checkbox-primary checkbox-sm" checked="checked">
                            <span class="label-text">${e}</span>
                        </label>
                    </div>`,u.prepend(i.firstElementChild),n.classList.remove("hidden"),o.classList.add("hidden")};const n=document.getElementById("add-categorie"),o=document.getElementById("add-categorie-input-container"),t=document.getElementById("add-categorie-input"),a=document.getElementById("add-categorie-submit-btn"),d=document.getElementById("add-categorie-cancel-btn"),l=document.getElementById("published_at_select_date"),s=document.getElementById("published_at_input"),b=document.getElementById("published_at_input_container"),v=document.getElementById("published_at_input_submit_btn"),I=document.getElementById("published_at_input_cancel_btn"),k=document.getElementById("published_at_text"),h=document.getElementById("published_at");document.getElementById("thumbnail").addEventListener("change",function(e){var p=e.target.files[0];if(p){var u=new FileReader;u.onload=function(i){document.getElementById("thumbnail-preview").src=i.target.result},u.readAsDataURL(p)}}),n.addEventListener("click",function(e){e.preventDefault(),this.classList.add("hidden"),o.classList.remove("hidden")}),a.addEventListener("click",function(e){e.preventDefault();const p=a.getAttribute("data-submit-url"),u=t.value;g.post(p,{name:u}).then(function(i){i.data.status=="success"&&(w(u,i.data.categoryId),Toast.success(i.data.message),t.value="")}).catch(function(i){Toast.danger(i.response.data.message)})}),d.addEventListener("click",function(e){e.preventDefault(),n.classList.remove("hidden"),o.classList.add("hidden")}),s.addEventListener("input",D),l.addEventListener("click",function(){b.classList.remove("hidden")}),v.addEventListener("click",function(e){e.preventDefault(),b.classList.add("hidden"),h.value=s.value,k.innerText="Publier le "+s.value}),I.addEventListener("click",function(e){e.preventDefault(),b.classList.add("hidden")})}if(f){const n=f.getAttribute("data-post-id"),o=document.querySelector("[data-btn-post-del]");(async function(t){try{let a=window.location.origin+"/admin/blog/post/get-data-editor/"+n;y=(await g.get(a,{params:{postId:n}})).data.content,B(y,n)}catch(a){throw console.error("Erreur lors de la requête au serveur :",a.message),a}})(),o.addEventListener("click",function(t){t.preventDefault();const a=this.getAttribute("data-btn-post-del");C("Vous êtes sur le point de supprimer un article, êtes-vous sûr(e) ?","default",function(d){d?(console.log(d),g.delete(a).then(function(l){l.data.status=="success"&&(window.location=l.data.redirectRoute)}).catch(function(l){console.log(l),Toast.danger("Il y a eu une erreur dans le processus de suppression de l'article, merci de réessayer après avoir rafraichi votre navigateur.")})):console.log("Suppression annulée !")})})}E&&(console.log("blogCreate"),B(y));function B(n,o){let t=n.length?JSON.parse(n):{},a=document.getElementById("title"),d=document.getElementById("excerpt"),l=document.getElementById("slug"),s,b=document.getElementById("thumbnail");const v=document.getElementById("btn-submit-post"),I=new _({holder:"editor",readOnly:!1,placeholder:"Tout est bon à dire du moment que c'est fait avec le coeur",tools:{header:q,list:R,checklist:P,quote:M,warning:F,marker:$,delimiter:N,embed:O,table:U,image:{class:j,config:{endpoints:{byFile:window.location.origin+"/admin/blog/uploadFile",byUrl:window.location.origin+"/admin/blog/fetchUrl"},additionalRequestHeaders:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}}},toggle:{class:H,inlineToolbar:!0}},data:t.length?JSON.parse(t):{},i18n:{messages:{ui:{Search:"Rechercher",popover:{Filter:"Filtrer","Convert to":"Convertir en"},blockTunes:{toggler:{"Click to tune":"Cliquer pour valider","or drag to move":"ou le faire glisser pour le déplacer"}},inlineToolbar:{converter:{"Convert to":"Convertir en"}},toolbar:{toolbox:{Add:"Ajouter"}}},toolNames:{Text:"Paragraphe",Heading:"Titre",List:"Liste",Warning:"Alerte",Checklist:"Checklist",Quote:"Citation",Delimiter:"Séparation",Table:"Tableau",Link:"Lien",Marker:"Marqueur",Bold:"Gras",Italic:"Italic"},tools:{warning:{Title:"Titre",Message:"Message"},link:{"Add a link":"Ajouter un lien"},stub:{"The block can not be displayed correctly.":"Le block ne peut pas s'afficher correctement."}},blockTunes:{delete:{Delete:"Supprimer","Click to delete":"Confirmer"},moveUp:{"Move up":"Monter d'un cran"},moveDown:{"Move down":"Descendre d'un cran"}}}}});v&&v.addEventListener("click",function(k){k.preventDefault(),I.save().then(h=>{const L=a.value,w=d.value,e=l.value;s=h;const p=b.files[0],u=document.querySelector('input[name="status"]:checked').value,i=document.querySelectorAll('#categories-list input[type="checkbox"]:checked'),x=Array.from(i).map(m=>m.value),S=document.querySelector('input[name="published_at"]:checked').value,r=new FormData;if(r.append("title",L),r.append("excerpt",w),r.append("slug",e),r.append("content",JSON.stringify(s)),r.append("thumbnail",p),r.append("status",u),r.append("publishedAt",S),x.forEach((m,c)=>{r.append("categories[]",m)}),E){let m=window.location.origin+"/admin/blog/post/store";g.post(m,r,{headers:{"Content-Type":"multipart/form-data"}}).then(function(c){c.data.status=="success"&&(window.location=c.data.redirectRoute)}).catch(function(c){Toast.danger(c.response.data.message)})}if(f){let m=window.location.origin+"/admin/blog/post/update/"+o;g.post(m,r,{headers:{"Content-Type":"multipart/form-data"}}).then(function(c){c.data.status=="success"&&(window.location=c.data.redirectRoute)}).catch(function(c){Toast.danger(c.response.data.message)})}}).catch(h=>{console.log("Saving failed: ",h)})})}function A(n){const o=n.getAttribute("data-copy-link");navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(o).then(()=>{alert("Le texte a bien été copié dans le presse-papiers : "+o)}).catch(t=>{console.error("Erreur lors de la copie du texte : ",t)}):(console.error("L'API Clipboard n'est pas supportée par ce navigateur."),alert("Votre navigateur ne supporte pas l'API Clipboard."))}});
