import{g as S}from"./index-DjKJqAo0.js";import{a as Ce}from"./axios-CCb-kr4I.js";document.addEventListener("DOMContentLoaded",()=>{const z=document.getElementById("drawing-cards");if(z){let we=function(){U.textContent=he[J]},F=function(){window.scrollTo({top:0,behavior:"smooth"}),J<Object.keys(he).length&&(J++,J<=4&&we()),J>4&&M==!1&&(U.classList.add("hidden"),oe.classList.remove("hidden"),re.classList.remove("hidden"))},x=window.location.hash;const P=document.getElementById("header-drawing-cards"),ie=document.getElementById("footer-drawing-cards");let _=new Date;_=_.toLocaleDateString();const j=document.getElementById("name-of-drawing-cards"),N=document.getElementById("total-cards-for-drawing-cards"),w=document.getElementById("tarot-cards"),Ee=document.getElementById("select-drawing-card-el"),f=document.getElementById("card_map"),ye=document.querySelectorAll("[data-to-step]"),ve=document.getElementById("btn-step-drawing-card"),G=document.getElementById("interpretation_drawing_card"),K=document.getElementById("spread-btn"),de=document.getElementById("shuffle-btn"),Q=document.getElementById("cut-btn");let k=JSON.parse(w.getAttribute("data-cards"));const X=JSON.parse(f.getAttribute("data-games"));let R;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?R=!0:R=!1;let T,D;R?(T=63.08,D=120):(T=114,D=216.83);let se=!1,A,C=0,O,Z,M=!1,I=[],le=[],$={};const be=[document.getElementById("sticky-header"),document.getElementById("sub-header")],Le=document.getElementById("footer");let ce=0;be.forEach(e=>{ce+=Number(e.offsetHeight)});let Se=Number(Le.offsetHeight);z.style.minHeight=`calc(100vh - ${ce}px - ${Se}px)`,function(){X.forEach(e=>{let t=document.createElement("li");t.setAttribute("data-total-cards",e.totalSelectedCards),t.classList="text-center cursor-pointer transition-all hover:scale-105";let n=e.name,r=document.createElement("h4");r.textContent=n;let a=e.description,o=document.createElement("p");o.textContent=a,r.classList="bg-accent/65",o.classList="bg-[#2800ff78] px-2",t.append(r),t.append(o),Ee.append(t),t.addEventListener("click",()=>{document.querySelectorAll("[data-total-cards]").forEach(s=>{s.classList.remove("scale-105")}),t.classList.add("scale-105"),ve.classList.remove("hidden"),A=e.totalSelectedCards,O=n,Z=e.slug,x=e.slug,j.innerText=O,N.innerText=`Vous avez sélectionné ${C} carte${C>1?"s":""} sur ${A}`})})}();const ue=function(e="Réaliser un nouveau tirage :"){let t=document.createElement("div"),n=document.createElement("ul"),r=document.createElement("span");X.filter(o=>o.slug!=x).forEach(o=>{let i=document.createElement("li"),s=document.createElement("a"),u=window.location.origin,c="/tarot",d="#"+o.slug,l=u+c;s.setAttribute("href",l+d),s.innerText=o.name,s.classList.add("btn","md:btn-sm","btn-primary","text-white/70","hover:text-white/70","active:text-white/70","focus:text-white/70"),i.append(s),n.append(i),s.addEventListener("click",function(m){m.preventDefault(),sessionStorage.removeItem("finalDrawToSave"),window.location=this.href,location.pathname=="/tarot"&&location.reload()})}),r.innerText=e,t.classList.add("p-4","bg-base-100","absolute","bottom-0","translate-y-full","w-full"),t.setAttribute("id","change_game_btns_container"),r.classList.add("text-xl","mb-3","inline-block"),n.classList.add("flex","gap-4","flex-wrap"),t.append(r),t.append(n),z.append(t)},W=function(e=null,t=null){window.scrollTo({top:0,behavior:"smooth"});const n=document.querySelectorAll("[data-step]");let r="DRAWING_CARD_INTRO",a=document.querySelector('[data-step="'+r+'"]');t!=null?(r=t,a=document.querySelector('[data-step="'+r+'"]'),n.forEach(o=>{o.classList.add("hidden")}),a&&a.classList.remove("hidden")):(r=e.getAttribute("data-to-step"),a=document.querySelector('[data-step="'+r+'"]'),n.forEach(o=>{o.classList.add("hidden")}),a.classList.remove("hidden")),r=="DRAWING_CARD"?(P.classList.remove("hidden"),ie.classList.remove("hidden"),se||me(k,w),ue()):P.classList.add("hidden")},me=function(e,t){se=!0,C=0,e.forEach((n,r)=>{let a=document.createElement("li"),o=document.createElement("div"),i=document.createElement("div");a.setAttribute("id","tarot-card-"+n.slug+"-"+n.id),a.setAttribute("data-number",n.numberArcane),a.classList.add("tarot-card"),o.classList.add("front-card"),i.classList.add("back-card"),a.style.width=T+"px",a.style.height=D+"px",t.style.width=T+"px",t.style.height=D+"px",o.innerHTML=`<img class="w-full h-full object-contain" src="${n.imgPath}"/>`,i.innerHTML='<img class="w-full h-full object-contain" src=" '+window.location.origin+'/imgs/tarot/back-card.png"/>',a.appendChild(i),a.appendChild(o),t.appendChild(a),Ie(a)})},De=function(){N.classList.remove("hidden");const e=w.getElementsByClassName("tarot-card"),t=e.length,n=360/t,r=R?100:180;for(let a=0;a<t;a++){const o=a*n,i=r*Math.cos(o*(Math.PI/180)),s=r*Math.sin(o*(Math.PI/180));e[a].style.transform=`translate(${i}px, ${s}px) rotate(${o+a*2}deg)`,e[a].addEventListener("mouseenter",()=>{e[a].style.transform=`translate(${i}px, ${s}px) rotate(${o+a*2}deg) scale(1.10)`}),e[a].addEventListener("mouseleave",()=>{e[a].style.transform=`translate(${i}px, ${s}px) rotate(${o+a*2}deg) scale(1)`})}w.classList.toggle("spread"),M=!0,K.classList.add("hidden"),N.parentElement.classList.remove("hidden"),F()},xe=function(){w.innerHTML="",C=0,k=S.utils.shuffle(k),me(k,w),I=[],N.innerText=`Vous avez sélectionné ${C} carte${C>1?"s":""} sur ${A}`;let e=document.querySelectorAll(".tarot-card");e.forEach((t,n)=>{S.to(t,{duration:.8,x:()=>S.utils.random(-260,260),y:()=>S.utils.random(-160,160),rotation:()=>S.utils.random(-120,120),stagger:0,ease:"power1-inOut",onComplete:()=>{S.to(e,{duration:.8,y:0,x:0,rotation:0,stagger:0,ease:"power1.inOut"}),de.classList.add("hidden"),Q.classList.remove("hidden"),Q.addEventListener("click",ke)}})}),F()},ke=function(){let t=w.children[1],n=Math.floor(Math.random()*22);k[n].id==k[0].id&&(n=Math.floor(Math.random()*22)),le=["cut",k[n].id,k[0].id],Array.from(t.classList).find(r=>r.startsWith("-translate-x-")),t.classList.add("transition-all"),t.classList.add("!translate-x-[105%]"),t.classList.add("z-10"),setTimeout(function(r){t.classList.remove("!translate-x-[105%]"),t.classList.remove("z-10"),setTimeout(function(){t.classList.remove("transition-all")},100)},500),Q.classList.add("hidden"),K.classList.remove("hidden"),K.addEventListener("click",De),F()},Te=function(){document.querySelectorAll(".tarot-card").forEach(t=>{S.to(t,{duration:1,x:()=>0,y:()=>0,rotation:()=>0,stagger:.2,ease:"power1.inOut"})})},Ie=function(e){e.addEventListener("click",function(){let t=e.getAttribute("id").split("-").pop(),n=I.find(r=>r==t);M&&(e.classList.add("selected","ring-2","ring-primary"),I.push(parseInt(t))),e.classList.contains("selected")&&n==t&&(e.classList.remove("selected","ring-2","ring-primary"),I=I.filter(r=>r!=t),M=!0),Be()})},Be=function(){I.length==A?(M=!1,G.classList.remove("hidden")):(M=!0,G.classList.add("hidden")),C=I.length,N.innerText=`Vous avez sélectionné ${C} carte${C>1?"s":""} sur ${A}`},qe=async()=>{try{const e=await pe(I,Z),t=await pe(le,"cut"),n=e.data,a={cut:t.data,draw:n};G.classList.add("hidden"),Te(),F(),$=a,$.date=_,$.name=O,sessionStorage.setItem("finalDrawToSave",JSON.stringify($));let o=n.drawSlug;o=="tirage-de-la-journee"?ae(a):o=="tirage-de-l-annee"?ne(a):o=="tirage-en-croix"?ee(a):te(a);return}catch(e){console.error("Erreur lors de l'interprétation du tirage :",e)}},pe=async(e,t)=>{try{let n=window.location.origin+"/tarot/interpretation";return Ce({method:"get",url:n,params:{drawCards:e,drawSlug:t}})}catch(n){throw console.error("Erreur lors de la requête au serveur :",n.message),n}};G.addEventListener("click",()=>{N.style.display="none",F(),qe()});const V=function(e){const t=e.draw,n=document.getElementById("draw-interpretation-block-cut").content,r=document.getElementById("cut-interpretation-card").content;let o=document.importNode(n,!0).querySelector(".tarot-cards-container"),i=o.querySelector(".block-interpretation"),s=document.createElement("div");console.log(i),Object.entries(t).forEach(([u,c])=>{if(!c.name)return;let d=document.importNode(r,!0),l=document.createElement("div"),m=document.createElement("h4"),p=document.createElement("span"),g=document.createElement("span"),E=document.createElement("p");d.querySelector(".card-img").setAttribute("src",c.path),d.querySelector(".tarot-card").style.width=T+"px",d.querySelector(".tarot-card").style.height=D+"px",g.innerText=c.nbArcane+" - ",p.innerText=c.name,m.appendChild(g),m.appendChild(p),E.innerText=c.interpretation,l.appendChild(m),l.appendChild(E),i.appendChild(l),s.appendChild(d)}),s.classList.add("block-cards-cut"),o.appendChild(s),f.firstElementChild.appendChild(o)},ee=function(e){console.log("process draw",e),S.to(w,{duration:1,scale:.8,opacity:0,ease:"power1.out",onComplete:()=>{setTimeout(()=>{w.remove(),f.classList.add("draw-cross"),V(e.cut);const n=e.draw.draw,r=document.getElementById("draw-interpretation-block-draw-cross").content,a=document.getElementById("draw-interpretation-card-draw-cross").content;let i=document.importNode(r,!0).querySelector(".tarot-cards-container"),s=i.querySelector(".block-interpretation"),u=document.createElement("div"),c=[];if(n.drawPositions)try{c=JSON.parse(JSON.parse(n.drawPositions))}catch(d){console.error("Error parsing JSON: ",d)}console.log(c),Object.entries(n).forEach(([d,l])=>{if(!l.name)return;let m=document.importNode(a,!0),p=document.createElement("div"),g=document.createElement("h4"),E=document.createElement("span"),B=document.createElement("span"),q=document.createElement("p");m.querySelector(".card-img").setAttribute("src",l.path),m.querySelector(".tarot-card").style.width=T+"px",m.querySelector(".tarot-card").style.height=D+"px",B.innerText=l.nbArcane+" - ",E.innerText=l.name,g.appendChild(B),g.appendChild(E),q.innerText=l.interpretation;let h=document.createElement("div"),y=document.createElement("span"),v=document.createElement("span"),b=document.createElement("span");h.classList.add("domaine"),y.classList.add("draw-domaine-icone"),v.classList.add("draw-domaine-text"),b.classList.add("draw-domaine-position");const L=c.find(H=>H.position===parseInt(d)+1);L&&(b.innerHTML=parseInt(d)+1,y.innerHTML=`<i class="${L.icone}"></i>`,v.innerText=L.keywords,h.appendChild(b),h.appendChild(v),h.appendChild(y),p.appendChild(h)),p.appendChild(g),p.appendChild(q),s.appendChild(p),u.appendChild(m)}),u.style.minHeight=D*3+"px",u.classList.add("block-cards-draw"),i.appendChild(u),f.firstElementChild.appendChild(i)},500)}})},te=function(e){S.to(w,{duration:1,scale:.8,opacity:0,ease:"power1.out",onComplete:()=>{setTimeout(()=>{w.remove(),f.classList.add("draw-spread"),V(e.cut);const n=e.draw.draw,r=document.getElementById("draw-interpretation-block-draw-spread").content,a=document.getElementById("draw-interpretation-card-draw-spread").content;let i=document.importNode(r,!0).querySelector(".tarot-cards-container"),s=i.querySelector(".block-interpretation"),u=document.createElement("div"),c=[];if(n.drawPositions)try{c=JSON.parse(JSON.parse(n.drawPositions))}catch(d){console.error("Error parsing JSON: ",d)}console.log(c),Object.entries(n).forEach(([d,l])=>{if(!l.name)return;let m=document.importNode(a,!0),p=document.createElement("div"),g=document.createElement("h4"),E=document.createElement("span"),B=document.createElement("span"),q=document.createElement("p");m.querySelector(".card-img").setAttribute("src",l.path),m.querySelector(".tarot-card").style.width=T+"px",m.querySelector(".tarot-card").style.height=D+"px",B.innerText=l.nbArcane+" - ",E.innerText=l.name,g.appendChild(B),g.appendChild(E),q.innerText=l.interpretation;let h=document.createElement("div"),y=document.createElement("span"),v=document.createElement("span"),b=document.createElement("span");h.classList.add("domaine"),y.classList.add("draw-domaine-icone"),v.classList.add("draw-domaine-text"),b.classList.add("draw-domaine-position");const L=c.find(H=>H.position===parseInt(d)+1);L&&(b.innerHTML=parseInt(d)+1,y.innerHTML=`<i class="${L.icone}"></i>`,v.innerText=L.keywords,h.appendChild(b),h.appendChild(v),h.appendChild(y),p.appendChild(h)),p.appendChild(g),p.appendChild(q),s.appendChild(p),u.appendChild(m)}),u.style.minHeight=D*3+"px",u.classList.add("block-cards-draw"),i.appendChild(u),f.firstElementChild.appendChild(i)},500)}})},ne=function(e){S.to(w,{duration:1,scale:.8,opacity:0,ease:"power1.out",onComplete:()=>{setTimeout(()=>{w.remove(),f.classList.add("draw-year"),V(e.cut);const n=e.draw.draw,r=document.getElementById("draw-interpretation-block-draw-year").content,a=document.getElementById("draw-interpretation-card-draw-year").content;let i=document.importNode(r,!0).querySelector(".tarot-cards-container");const s=JSON.parse(JSON.parse(n.drawPositions));Object.entries(n).forEach(([u,c])=>{if(!c.name)return;let d=document.importNode(a,!0);d.querySelector(".block-card-year .card-img").setAttribute("src",c.path),d.querySelector(".card-nb").innerText=c.nbArcane+" - ",d.querySelector(".card-name").innerText=c.name,d.querySelector(".card-interpretation-text").innerText=c.interpretation;const l=s.find(m=>m.position===parseInt(u)+1);l?(d.querySelector(".draw-domaine-icone").innerHTML=`<i class="${l.icone}"></i>`,d.querySelector(".draw-domaine-text").innerText=l.keywords):(d.querySelector(".draw-domaine-icone").innerHTML='<i class="fa-thin fa-t-rex"></i>',d.querySelector(".draw-domaine-text").innerText="Général"),i.appendChild(d)}),f.firstElementChild.appendChild(i)},500)}})},ae=function(e){S.to(w,{duration:1,scale:.8,opacity:0,ease:"power1.out",onComplete:()=>{setTimeout(()=>{w.remove(),f.classList.add("draw-day"),V(e.cut);const n=e.draw.draw,r=document.getElementById("draw-interpretation-block-draw-day").content,a=document.getElementById("draw-interpretation-card-draw-day").content;let i=document.importNode(r,!0).querySelector(".tarot-cards-container"),s=i.querySelector(".block-interpretation"),u=document.createElement("div"),c=[];if(n.drawPositions)try{c=JSON.parse(JSON.parse(n.drawPositions))}catch(d){console.error("Error parsing JSON: ",d)}console.log(c),Object.entries(n).forEach(([d,l])=>{if(!l.name)return;let m=document.importNode(a,!0),p=document.createElement("div"),g=document.createElement("h4"),E=document.createElement("span"),B=document.createElement("span"),q=document.createElement("p");m.querySelector(".card-img").setAttribute("src",l.path),m.querySelector(".tarot-card").style.width=T+"px",m.querySelector(".tarot-card").style.height=D+"px",B.innerText=l.nbArcane+" - ",E.innerText=l.name,g.appendChild(B),g.appendChild(E),q.innerText=l.interpretation;let h=document.createElement("div"),y=document.createElement("span"),v=document.createElement("span"),b=document.createElement("span");h.classList.add("domaine"),y.classList.add("draw-domaine-icone"),v.classList.add("draw-domaine-text"),b.classList.add("draw-domaine-position");const L=c.find(H=>H.position===parseInt(d)+1);L&&(b.innerHTML=parseInt(d)+1,y.innerHTML=`<i class="${L.icone}"></i>`,v.innerText=L.keywords,h.appendChild(b),h.appendChild(v),h.appendChild(y),p.appendChild(h)),p.appendChild(g),p.appendChild(q),s.appendChild(p),u.appendChild(m)}),u.classList.add("block-cards-draw"),i.appendChild(u),f.firstElementChild.appendChild(i)},500)}})};let re=document.getElementById("date-of-drawing-cards");re.innerText="Le : "+_;let J=0,U=document.getElementById("notice-of-drawing-cards"),oe=document.getElementById("draw-actions"),he={0:'Faites le vide dans votre esprit et respirez tranquillement trois fois puis mélangez les cartes en cliquant sur le bouton "Mélanger"',1:'Parfait, maintenant, concentrez-vous sur votre question puis coupez les cartes en cliquant sur le bouton "Couper"',2:'Maintenant, étalez le jeu en cliquant sur le bouton "Etaler"',3:"Parmis les cartes qui se présentent à vous, sélectionnez celles qui vous inspirent en cliquant sur chacune d'elles, vous pouvez en changer, mais sachez que votre première intuition est souvent la bonne, restez léger.",4:'Bien, maintenant que vous avez sélectionné toutes vos cartes pour votre tirage, cliquez sur le bouton "Interpréter mon tirage" pour obtenir votre interprétation.'};we();const Ne=document.getElementById("open-save-draw"),ge=document.getElementById("drawer-save"),Y=document.getElementById("new-draw"),Ae=document.getElementById("drawer-save-close"),fe=document.getElementById("save-draw-btn");Y.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation();let t=e.target;for(;t&&t!==Y;)t=t.parentNode;if(t===Y){const n=Y.getAttribute("href");sessionStorage.removeItem("finalDrawToSave"),window.location=n}}),Ne.addEventListener("click",e=>{e.preventDefault(),ge.setAttribute("checked",!0)}),Ae.addEventListener("click",e=>{e.preventDefault(),ge.removeAttribute("checked")}),fe&&fe.addEventListener("click",e=>{e.preventDefault(),Oe($)});const Oe=function(e){let t=null,n=null;const r=document.getElementById("feeling"),a=document.getElementById("question");r.value&&(t=r.value),a.value&&(n=a.value),console.log("feelingEl",t),console.log("questionEl",n);const o=sessionStorage.getItem("finalDrawToSave"),i=o||e;console.log("name",O),Ce({method:"post",url:"/tarot/save-draw-cards",data:{draw:JSON.parse(i),feeling:t,question:n}}).then(function(s){s.status==200?(console.log("Tirage enregistré avec succès",s.data.id),sessionStorage.removeItem("finalDrawToSave"),window.location=window.location.origin+"/tarot/tirage/"+s.data.id):console.error("Erreur lors de l'enregistrement du tirage")})};x&&(x=x.substring(1),X.forEach(e=>{e.slug==x&&(P.classList.remove("hidden"),W(null,"DRAWING_CARD"),A=e.totalSelectedCards,O=e.name,Z=e.slug,j.innerText=O,N.innerText=`Vous avez sélectionné ${C} carte${C>1?"s":""} sur ${A}`)})),ye.forEach(e=>{e.addEventListener("click",()=>{W(e)})}),de.addEventListener("click",xe),function(){const e=document.querySelector("[data-user-draw]");if(e){const n=e.getAttribute("data-user-draw");if(n!=="")try{W(null,"FINALY_STEP"),f.classList.remove("hidden"),P.classList.remove("hidden"),ue("Réaliser un nouveau tirage :"),U.classList.add("hidden"),oe.classList.remove("hidden");const r=n.replace(/&quot;/g,'"'),a=JSON.parse(r),o=a.draw,i=JSON.parse(o.replace(/&quot;/g,'"').replace(/&#039;/g,"'"));let s=document.getElementById("date-of-drawing-cards");s.innerText="Le : "+i.date,s.classList.remove("hidden"),console.log("unescapedNestedDraw",i);const u=i,d=u.draw.drawSlug,l=a.created_at,m=a.updated_at;j.innerText=u.name,d=="tirage-de-la-journee"?ae(u):d=="tirage-de-l-annee"?ne(u):d=="tirage-en-croix"?ee(u):te(u);return}catch(r){console.error("Erreur lors du parsing JSON :",r)}}const t=JSON.parse(sessionStorage.getItem("finalDrawToSave"));if(t){console.log("savedFinalDraw",t);try{W(null,"FINALY_STEP"),f.classList.remove("hidden"),P.classList.remove("hidden"),ie.classList.add("hidden"),U.classList.add("hidden"),oe.classList.remove("hidden"),re.classList.remove("hidden"),j.innerText=t.name;const r=t.draw.drawSlug;r=="tirage-de-la-journee"?ae(t):r=="tirage-de-l-annee"?ne(t):r=="tirage-en-croix"?ee(t):te(t);return}catch(n){console.error("Erreur lors du parsing JSON :",n)}return}}()}});window.addEventListener("beforeunload",function(z){let x=document.referrer&&new URL(document.referrer).origin!==window.location.origin;console.log("isNavigatingAway",x),x&&sessionStorage.removeItem("finalDrawToSave")});
