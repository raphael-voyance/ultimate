import{g as S}from"./index-DjKJqAo0.js";import{a as we}from"./axios-CCb-kr4I.js";document.addEventListener("DOMContentLoaded",()=>{const Y=document.getElementById("drawing-cards");if(Y){let me=function(){V.textContent=ue[J]},F=function(){window.scrollTo({top:0,behavior:"smooth"}),J<Object.keys(ue).length&&(J++,J<=4&&me()),J>4&&M==!1&&(V.classList.add("hidden"),re.classList.remove("hidden"),ae.classList.remove("hidden"))},A=window.location.hash;const P=document.getElementById("header-drawing-cards"),ge=document.getElementById("footer-drawing-cards");let z=new Date;z=z.toLocaleDateString();const j=document.getElementById("name-of-drawing-cards"),q=document.getElementById("total-cards-for-drawing-cards"),g=document.getElementById("tarot-cards"),Ce=document.getElementById("select-drawing-card-el"),f=document.getElementById("card_map"),fe=document.querySelectorAll("[data-to-step]"),Ee=document.getElementById("btn-step-drawing-card"),_=document.getElementById("interpretation_drawing_card"),U=document.getElementById("spread-btn"),oe=document.getElementById("shuffle-btn"),K=document.getElementById("cut-btn");let k=JSON.parse(g.getAttribute("data-cards"));const Q=JSON.parse(g.getAttribute("data-games"));let G;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?G=!0:G=!1;let T,D;G?(T=63.08,D=120):(T=114,D=216.83);let de=!1,N,E=0,O,X,M=!1,I=[],ie=[],$={};const ye=[document.getElementById("sticky-header"),document.getElementById("sub-header")],ve=document.getElementById("footer");let se=0;ye.forEach(e=>{se+=Number(e.offsetHeight)});let be=Number(ve.offsetHeight);Y.style.minHeight=`calc(100vh - ${se}px - ${be}px)`,function(){Q.forEach(e=>{let t=document.createElement("li");t.setAttribute("data-total-cards",e.totalSelectedCards),t.classList="text-center cursor-pointer transition-all hover:scale-105";let n=e.name,r=document.createElement("h4");r.textContent=n;let a=e.description,o=document.createElement("p");o.textContent=a,r.classList="bg-accent/65",o.classList="bg-[#2800ff78] px-2",t.append(r),t.append(o),Ce.append(t),t.addEventListener("click",()=>{document.querySelectorAll("[data-total-cards]").forEach(c=>{c.classList.remove("scale-105")}),t.classList.add("scale-105"),Ee.classList.remove("hidden"),N=e.totalSelectedCards,O=n,X=e.slug,A=e.slug,j.innerText=O,q.innerText=`Vous avez sélectionné ${E} carte${E>1?"s":""} sur ${N}`})})}();const R=function(e=null,t=null){window.scrollTo({top:0,behavior:"smooth"});const n=document.querySelectorAll("[data-step]");let r="DRAWING_CARD_INTRO",a=document.querySelector('[data-step="'+r+'"]');if(t!=null?(r=t,a=document.querySelector('[data-step="'+r+'"]'),n.forEach(o=>{o.classList.add("hidden")}),a&&a.classList.remove("hidden")):(r=e.getAttribute("data-to-step"),a=document.querySelector('[data-step="'+r+'"]'),n.forEach(o=>{o.classList.add("hidden")}),a.classList.remove("hidden")),r=="DRAWING_CARD"){P.classList.remove("hidden"),ge.classList.remove("hidden"),de||le(k,g);let o=document.createElement("div"),i=document.createElement("ul"),c=document.createElement("span");Q.filter(l=>l.slug!=A).forEach(l=>{let d=document.createElement("li"),s=document.createElement("a"),m=window.location.origin,p=window.location.pathname,h="#"+l.slug,C=m+p;s.setAttribute("href",C+h),s.innerText=l.name,s.classList.add("btn","md:btn-sm","btn-primary","text-white/70","hover:text-white/70","active:text-white/70","focus:text-white/70"),d.append(s),i.append(d),s.addEventListener("click",function(x){x.preventDefault(),window.location.hash=h,location.reload()})}),c.innerText="Changer de tirage :",o.classList.add("p-4","bg-base-100","absolute","bottom-0","translate-y-full","w-full"),c.classList.add("text-xl","mb-3","inline-block"),i.classList.add("flex","gap-4","flex-wrap"),o.append(c),o.append(i),Y.append(o)}else P.classList.add("hidden")},le=function(e,t){de=!0,E=0,e.forEach((n,r)=>{let a=document.createElement("li"),o=document.createElement("div"),i=document.createElement("div");a.setAttribute("id","tarot-card-"+n.slug+"-"+n.id),a.setAttribute("data-number",n.numberArcane),a.classList.add("tarot-card"),o.classList.add("front-card"),i.classList.add("back-card"),a.style.width=T+"px",a.style.height=D+"px",t.style.width=T+"px",t.style.height=D+"px",o.innerHTML=`<img class="w-full h-full object-contain" src="${n.imgPath}"/>`,i.innerHTML='<img class="w-full h-full object-contain" src=" '+window.location.origin+'/imgs/tarot/back-card.png"/>',a.appendChild(i),a.appendChild(o),t.appendChild(a),ke(a)})},Le=function(){q.classList.remove("hidden");const e=g.getElementsByClassName("tarot-card"),t=e.length,n=360/t,r=G?100:180;for(let a=0;a<t;a++){const o=a*n,i=r*Math.cos(o*(Math.PI/180)),c=r*Math.sin(o*(Math.PI/180));e[a].style.transform=`translate(${i}px, ${c}px) rotate(${o+a*2}deg)`,e[a].addEventListener("mouseenter",()=>{e[a].style.transform=`translate(${i}px, ${c}px) rotate(${o+a*2}deg) scale(1.10)`}),e[a].addEventListener("mouseleave",()=>{e[a].style.transform=`translate(${i}px, ${c}px) rotate(${o+a*2}deg) scale(1)`})}g.classList.toggle("spread"),M=!0,U.classList.add("hidden"),q.parentElement.classList.remove("hidden"),F()},Se=function(){g.innerHTML="",E=0,k=S.utils.shuffle(k),le(k,g),I=[],q.innerText=`Vous avez sélectionné ${E} carte${E>1?"s":""} sur ${N}`;let e=document.querySelectorAll(".tarot-card");e.forEach((t,n)=>{S.to(t,{duration:.8,x:()=>S.utils.random(-260,260),y:()=>S.utils.random(-160,160),rotation:()=>S.utils.random(-120,120),stagger:0,ease:"power1-inOut",onComplete:()=>{S.to(e,{duration:.8,y:0,x:0,rotation:0,stagger:0,ease:"power1.inOut"}),oe.classList.add("hidden"),K.classList.remove("hidden"),K.addEventListener("click",De)}})}),F()},De=function(){let t=g.children[1],n=Math.floor(Math.random()*22);k[n].id==k[0].id&&(n=Math.floor(Math.random()*22)),ie=["cut",k[n].id,k[0].id],Array.from(t.classList).find(r=>r.startsWith("-translate-x-")),t.classList.add("transition-all"),t.classList.add("!translate-x-[105%]"),t.classList.add("z-10"),setTimeout(function(r){t.classList.remove("!translate-x-[105%]"),t.classList.remove("z-10"),setTimeout(function(){t.classList.remove("transition-all")},100)},500),K.classList.add("hidden"),U.classList.remove("hidden"),U.addEventListener("click",Le),F()},xe=function(){document.querySelectorAll(".tarot-card").forEach(t=>{S.to(t,{duration:1,x:()=>0,y:()=>0,rotation:()=>0,stagger:.2,ease:"power1.inOut"})})},ke=function(e){e.addEventListener("click",function(){let t=e.getAttribute("id").split("-").pop(),n=I.find(r=>r==t);M&&(e.classList.add("selected","ring-2","ring-primary"),I.push(parseInt(t))),e.classList.contains("selected")&&n==t&&(e.classList.remove("selected","ring-2","ring-primary"),I=I.filter(r=>r!=t),M=!0),Te()})},Te=function(){I.length==N?(M=!1,_.classList.remove("hidden")):(M=!0,_.classList.add("hidden")),E=I.length,q.innerText=`Vous avez sélectionné ${E} carte${E>1?"s":""} sur ${N}`},Ie=async()=>{try{const e=await ce(I,X),t=await ce(ie,"cut"),n=e.data,a={cut:t.data,draw:n};_.classList.add("hidden"),xe(),F(),$=a,$.date=z,$.name=O,localStorage.setItem("finalDrawToSave",JSON.stringify($));let o=n.drawSlug;o=="tirage-de-la-journee"?ne(a):o=="tirage-de-l-annee"?te(a):o=="tirage-en-croix"?Z(a):ee(a);return}catch(e){console.error("Erreur lors de l'interprétation du tirage :",e)}},ce=async(e,t)=>{try{let n=window.location.origin+"/tarot/interpretation";return we({method:"get",url:n,params:{drawCards:e,drawSlug:t}})}catch(n){throw console.error("Erreur lors de la requête au serveur :",n.message),n}};_.addEventListener("click",()=>{q.style.display="none",F(),Ie()});const W=function(e){const t=e.draw,n=document.getElementById("draw-interpretation-block-cut").content,r=document.getElementById("cut-interpretation-card").content;let o=document.importNode(n,!0).querySelector(".tarot-cards-container"),i=o.querySelector(".block-interpretation"),c=document.createElement("div");console.log(i),Object.entries(t).forEach(([u,l])=>{if(!l.name)return;let d=document.importNode(r,!0),s=document.createElement("div"),m=document.createElement("h4"),p=document.createElement("span"),h=document.createElement("span"),C=document.createElement("p");d.querySelector(".card-img").setAttribute("src",l.path),d.querySelector(".tarot-card").style.width=T+"px",d.querySelector(".tarot-card").style.height=D+"px",h.innerText=l.nbArcane+" - ",p.innerText=l.name,m.appendChild(h),m.appendChild(p),C.innerText=l.interpretation,s.appendChild(m),s.appendChild(C),i.appendChild(s),c.appendChild(d)}),c.classList.add("block-cards-cut"),o.appendChild(c),f.firstElementChild.appendChild(o)},Z=function(e){console.log("process draw",e),S.to(g,{duration:1,scale:.8,opacity:0,ease:"power1.out",onComplete:()=>{setTimeout(()=>{g.remove(),f.classList.add("draw-cross"),W(e.cut);const n=e.draw.draw,r=document.getElementById("draw-interpretation-block-draw-cross").content,a=document.getElementById("draw-interpretation-card-draw-cross").content;let i=document.importNode(r,!0).querySelector(".tarot-cards-container"),c=i.querySelector(".block-interpretation"),u=document.createElement("div"),l=[];if(n.drawPositions)try{l=JSON.parse(JSON.parse(n.drawPositions))}catch(d){console.error("Error parsing JSON: ",d)}console.log(l),Object.entries(n).forEach(([d,s])=>{if(!s.name)return;let m=document.importNode(a,!0),p=document.createElement("div"),h=document.createElement("h4"),C=document.createElement("span"),x=document.createElement("span"),B=document.createElement("p");m.querySelector(".card-img").setAttribute("src",s.path),m.querySelector(".tarot-card").style.width=T+"px",m.querySelector(".tarot-card").style.height=D+"px",x.innerText=s.nbArcane+" - ",C.innerText=s.name,h.appendChild(x),h.appendChild(C),B.innerText=s.interpretation;let w=document.createElement("div"),y=document.createElement("span"),v=document.createElement("span"),b=document.createElement("span");w.classList.add("domaine"),y.classList.add("draw-domaine-icone"),v.classList.add("draw-domaine-text"),b.classList.add("draw-domaine-position");const L=l.find(H=>H.position===parseInt(d)+1);L&&(b.innerHTML=parseInt(d)+1,y.innerHTML=`<i class="${L.icone}"></i>`,v.innerText=L.keywords,w.appendChild(b),w.appendChild(v),w.appendChild(y),p.appendChild(w)),p.appendChild(h),p.appendChild(B),c.appendChild(p),u.appendChild(m)}),u.style.minHeight=D*3+"px",u.classList.add("block-cards-draw"),i.appendChild(u),f.firstElementChild.appendChild(i)},500)}})},ee=function(e){S.to(g,{duration:1,scale:.8,opacity:0,ease:"power1.out",onComplete:()=>{setTimeout(()=>{g.remove(),f.classList.add("draw-spread"),W(e.cut);const n=e.draw.draw,r=document.getElementById("draw-interpretation-block-draw-spread").content,a=document.getElementById("draw-interpretation-card-draw-spread").content;let i=document.importNode(r,!0).querySelector(".tarot-cards-container"),c=i.querySelector(".block-interpretation"),u=document.createElement("div"),l=[];if(n.drawPositions)try{l=JSON.parse(JSON.parse(n.drawPositions))}catch(d){console.error("Error parsing JSON: ",d)}console.log(l),Object.entries(n).forEach(([d,s])=>{if(!s.name)return;let m=document.importNode(a,!0),p=document.createElement("div"),h=document.createElement("h4"),C=document.createElement("span"),x=document.createElement("span"),B=document.createElement("p");m.querySelector(".card-img").setAttribute("src",s.path),m.querySelector(".tarot-card").style.width=T+"px",m.querySelector(".tarot-card").style.height=D+"px",x.innerText=s.nbArcane+" - ",C.innerText=s.name,h.appendChild(x),h.appendChild(C),B.innerText=s.interpretation;let w=document.createElement("div"),y=document.createElement("span"),v=document.createElement("span"),b=document.createElement("span");w.classList.add("domaine"),y.classList.add("draw-domaine-icone"),v.classList.add("draw-domaine-text"),b.classList.add("draw-domaine-position");const L=l.find(H=>H.position===parseInt(d)+1);L&&(b.innerHTML=parseInt(d)+1,y.innerHTML=`<i class="${L.icone}"></i>`,v.innerText=L.keywords,w.appendChild(b),w.appendChild(v),w.appendChild(y),p.appendChild(w)),p.appendChild(h),p.appendChild(B),c.appendChild(p),u.appendChild(m)}),u.style.minHeight=D*3+"px",u.classList.add("block-cards-draw"),i.appendChild(u),f.firstElementChild.appendChild(i)},500)}})},te=function(e){S.to(g,{duration:1,scale:.8,opacity:0,ease:"power1.out",onComplete:()=>{setTimeout(()=>{g.remove(),f.classList.add("draw-year"),W(e.cut);const n=e.draw.draw,r=document.getElementById("draw-interpretation-block-draw-year").content,a=document.getElementById("draw-interpretation-card-draw-year").content;let i=document.importNode(r,!0).querySelector(".tarot-cards-container");const c=JSON.parse(JSON.parse(n.drawPositions));Object.entries(n).forEach(([u,l])=>{if(!l.name)return;let d=document.importNode(a,!0);d.querySelector(".block-card-year .card-img").setAttribute("src",l.path),d.querySelector(".card-nb").innerText=l.nbArcane+" - ",d.querySelector(".card-name").innerText=l.name,d.querySelector(".card-interpretation-text").innerText=l.interpretation;const s=c.find(m=>m.position===parseInt(u)+1);s?(d.querySelector(".draw-domaine-icone").innerHTML=`<i class="${s.icone}"></i>`,d.querySelector(".draw-domaine-text").innerText=s.keywords):(d.querySelector(".draw-domaine-icone").innerHTML='<i class="fa-thin fa-t-rex"></i>',d.querySelector(".draw-domaine-text").innerText="Général"),i.appendChild(d)}),f.firstElementChild.appendChild(i)},500)}})},ne=function(e){S.to(g,{duration:1,scale:.8,opacity:0,ease:"power1.out",onComplete:()=>{setTimeout(()=>{g.remove(),f.classList.add("draw-day"),W(e.cut);const n=e.draw.draw,r=document.getElementById("draw-interpretation-block-draw-day").content,a=document.getElementById("draw-interpretation-card-draw-day").content;let i=document.importNode(r,!0).querySelector(".tarot-cards-container"),c=i.querySelector(".block-interpretation"),u=document.createElement("div"),l=[];if(n.drawPositions)try{l=JSON.parse(JSON.parse(n.drawPositions))}catch(d){console.error("Error parsing JSON: ",d)}console.log(l),Object.entries(n).forEach(([d,s])=>{if(!s.name)return;let m=document.importNode(a,!0),p=document.createElement("div"),h=document.createElement("h4"),C=document.createElement("span"),x=document.createElement("span"),B=document.createElement("p");m.querySelector(".card-img").setAttribute("src",s.path),m.querySelector(".tarot-card").style.width=T+"px",m.querySelector(".tarot-card").style.height=D+"px",x.innerText=s.nbArcane+" - ",C.innerText=s.name,h.appendChild(x),h.appendChild(C),B.innerText=s.interpretation;let w=document.createElement("div"),y=document.createElement("span"),v=document.createElement("span"),b=document.createElement("span");w.classList.add("domaine"),y.classList.add("draw-domaine-icone"),v.classList.add("draw-domaine-text"),b.classList.add("draw-domaine-position");const L=l.find(H=>H.position===parseInt(d)+1);L&&(b.innerHTML=parseInt(d)+1,y.innerHTML=`<i class="${L.icone}"></i>`,v.innerText=L.keywords,w.appendChild(b),w.appendChild(v),w.appendChild(y),p.appendChild(w)),p.appendChild(h),p.appendChild(B),c.appendChild(p),u.appendChild(m)}),u.classList.add("block-cards-draw"),i.appendChild(u),f.firstElementChild.appendChild(i)},500)}})};let ae=document.getElementById("date-of-drawing-cards");ae.innerText="Le : "+z;let J=0,V=document.getElementById("notice-of-drawing-cards"),re=document.getElementById("draw-actions"),ue={0:'Faites le vide dans votre esprit et respirez tranquillement trois fois puis mélangez les cartes en cliquant sur le bouton "Mélanger"',1:'Parfait, maintenant, concentrez-vous sur votre question puis coupez les cartes en cliquant sur le bouton "Couper"',2:'Maintenant, étalez le jeu en cliquant sur le bouton "Etaler"',3:"Parmis les cartes qui se présentent à vous, sélectionnez celles qui vous inspirent en cliquant sur chacune d'elles, vous pouvez en changer, mais sachez que votre première intuition est souvent la bonne, restez léger.",4:'Bien, maintenant que vous avez sélectionné toutes vos cartes pour votre tirage, cliquez sur le bouton "Interpréter mon tirage" pour obtenir votre interprétation.'};me();const Be=document.getElementById("open-save-draw"),pe=document.getElementById("drawer-save"),qe=document.getElementById("drawer-save-close"),he=document.getElementById("save-draw-btn");Be.addEventListener("click",e=>{e.preventDefault(),pe.setAttribute("checked",!0)}),qe.addEventListener("click",e=>{e.preventDefault(),pe.removeAttribute("checked")}),he&&he.addEventListener("click",e=>{e.preventDefault(),Ne($)});const Ne=function(e){const t=localStorage.getItem("finalDrawToSave"),n=t||e;console.log("name",O),we({method:"post",url:"/tarot/save-draw-cards",data:{draw:JSON.parse(n)}}).then(function(r){r.status==200?(console.log("Tirage enregistré avec succès",r.data.id),localStorage.removeItem("finalDrawToSave"),window.location=window.location.origin+"/tarot/tirage/"+r.data.id):console.error("Erreur lors de l'enregistrement du tirage")})};A&&(A=A.substring(1),Q.forEach(e=>{e.slug==A&&(P.classList.remove("hidden"),R(null,"DRAWING_CARD"),N=e.totalSelectedCards,O=e.name,X=e.slug,j.innerText=O,q.innerText=`Vous avez sélectionné ${E} carte${E>1?"s":""} sur ${N}`)})),fe.forEach(e=>{e.addEventListener("click",()=>{R(e)})}),oe.addEventListener("click",Se),function(){const e=document.querySelector("[data-user-draw]");if(e){const n=e.getAttribute("data-user-draw");if(n!=="")try{R(null,"FINALY_STEP"),f.classList.remove("hidden"),P.classList.remove("hidden"),V.classList.add("hidden"),re.classList.remove("hidden");const r=n.replace(/&quot;/g,'"'),a=JSON.parse(r),o=a.draw,i=JSON.parse(o.replace(/&quot;/g,'"').replace(/&#039;/g,"'"));let c=document.getElementById("date-of-drawing-cards");c.innerText="Le : "+i.date,c.classList.remove("hidden"),console.log("unescapedNestedDraw",i);const u=i,d=u.draw.drawSlug,s=a.created_at,m=a.updated_at;j.innerText=u.name,d=="tirage-de-la-journee"?ne(u):d=="tirage-de-l-annee"?te(u):d=="tirage-en-croix"?Z(u):ee(u);return}catch(r){console.error("Erreur lors du parsing JSON :",r)}}const t=JSON.parse(localStorage.getItem("finalDrawToSave"));if(t){console.log("savedFinalDraw",t);try{R(null,"FINALY_STEP"),f.classList.remove("hidden"),P.classList.remove("hidden"),V.classList.add("hidden"),re.classList.remove("hidden"),ae.classList.remove("hidden"),j.innerText=t.name;const r=t.draw.drawSlug;r=="tirage-de-la-journee"?ne(t):r=="tirage-de-l-annee"?te(t):r=="tirage-en-croix"?Z(t):ee(t);return}catch(n){console.error("Erreur lors du parsing JSON :",n)}return}}()}});
